define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(e,t){function r(e){return t.pushState(e.data,e.title,e.url)}function n(){return t.getState()}function a(e){return t.replaceState(e.data,e.title,e.url)}function o(){var r=e.reactive.Observable,a=e.reactive.Disposable;return r.createWithDisposable(function(e){return t.Adapter.bind(window,"statechange",function(){e.onNext(n())}),a.create(function(){window.onstatechange=null})}).publishValue(n()).refCount()}return{add:r,get:n,replace:a,observe:o}}),define("scalejs.routing-historyjs/routeMapper",["scalejs!core"],function(e){var t=e.object.clone;return function(e){function r(){var t,r;o=e.replace(/^\/*|[/?]*$/g,""),t=o.match(/{([^}])*}/g),t&&(u=t.map(function(e){return e.replace(/[{}]/g,"")})),r="^[/]*"+o.replace(/{[^}]*}/g,"(.+?)")+"[?/]*$",i=new RegExp(r)}function n(e){var t,r,n,a,o={};return t=e.split(/\/*\?/),r=t[0],n=e.substring(r.length).replace(/^[?/]*/,""),a=r.match(i),null===a?null:(a.shift(),a.forEach(function(e,t){o[u[t]]=e}),n.split("&").map(function(e){var t=e.split("="),r=t[0],n=t[1];r&&(o[r]=n)}),o)}function a(e){e=e?t(e):{};var r,n={};return r=u.reduce(function(t,r){var n=t.replace("{"+r+"}",e[r]);return delete e[r],n},o),n=Object.keys(e).map(function(t){return t+"="+e[t]}).join("&"),"/"+r+(n?"?"+n:"")}var o,i,u=[];return r(),{fromUrl:n,toUrl:a}}}),define("scalejs.routing-historyjs/router",["./routeMapper"],function(e){function t(t,r){var n=e(r);o[t]=n}function r(e,t){var r,n;if(!(t.indexOf(i)<0))return t=t.substring(i.length),r=o[e],r?n=r.fromUrl(t):void 0}function n(e,t){var r,n;return r=o[e],r?(n=r.toUrl(t),i+n):void 0}function a(e){i=e||"",i=i.replace(/\/*$/,"")}var o={},i="";return{addRoute:t,tryToUrl:n,tryFromUrl:r,setBaseUrl:a}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","./router","scalejs.statechart-scion","scalejs.reactive"],function(e,t,r){function n(e){w?(w=!1,t.replace({url:e})):t.add({url:e})}function a(){var e;U.add(y().subscribe(function(e){var t;"entry"===e.event&&(t=r.tryToUrl(e.state,e.currentEvent?e.currentEvent.data:null),t&&n(t))})),U.add(t.observe().subscribe(function(t){var r=t.hash;e!==r&&(e=r,b("routed",{url:r},0))}))}function o(){U.dispose()}function i(e){return h(function(t){var n;r.addRoute(t.id,e),n=f("routed",function(e){var n=r.tryFromUrl(t.id,e.data.url);return n?(l(e.data,n),!0):void 0},p(t.id)),s?j(s,n):m.push(n)})}function u(e,t){var n,i;return s=e,c(t,"baseUrl")?(r.setBaseUrl(t.baseUrl),n=d(arguments).slice(2,arguments.length)):n=d(arguments).slice(1,arguments.length),i=g.apply(null,[s,f("router.disposing",p("router.disposed")),g("router.waiting",v(a)),g("router.disposed",v(o))].concat(m).concat(n))}var s,c=e.object.has,l=e.object.extend,d=e.array.toArray,f=e.state.builder.on,p=e.state.builder.gotoInternally,v=e.state.builder.onEntry,g=e.state.builder.state,b=e.state.raise,h=e.functional.builder.$yield,j=e.state.registerTransition,y=e.state.observe,m=[],U=new e.reactive.CompositeDisposable,w=!0;return{route:i,routerState:u}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(e,t){e.registerExtension({routing:t})});