define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(t,e){function n(t){e.pushState(t.data,t.title,t.url)}function r(){e.getState()}function o(t){e.replaceState(t.data,t.title,t.url)}function i(){var n=t.reactive.Observable,r=t.reactive.Disposable;return n.createWithDisposable(function(t){var n=e.Adapter.bind(window,"statechange",function(){t.onNext(e.getState())});return r.create(function(){n.detach()})}).publishValue(e.getState()).refCount()}return{add:n,get:r,replace:o,observe:i}}),define("scalejs.routing-historyjs/routing",["./history","scalejs.statechart-scion"],function(t){function e(e){function n(t){var e=t.split("&"),n={};return e.forEach(function(t){t=t.split("="),n[t[0]]=decodeURIComponent(t[1])}),n}function r(t,e){function n(t,e){var r=Object.keys(t);l(e)||(e=""),r.forEach(function(r){f(t[r],"object")?n(t[r],r):f(t[r],"array")?o.push(e+encodeURIComponent(r)+"="+encodeURIComponent(t[r].join(","))):o.push(e+encodeURIComponent(r)+"="+encodeURIComponent(t[r]))})}var r="",o=[];return l(t)&&(r="?"+t),l(e)&&(r+="?",n(e),r+=o.join("&")),r}function o(t){var e,r=t.hash.replace("/","");return-1!==r.indexOf("&_suid")&&(r=r.substr(0,r.indexOf("&_suid"))),t=t.hash.replace("/","").replace("?",""),""===t?{url:r}:(t=t.split("?"),-1!==t[0].indexOf("&")?{query:n(t[0]),url:r}:(e=decodeURIComponent(t[0]),l(t[1])?{location:e,query:n(t[1]),url:r}:{location:e,url:r}))}function i(){return s.where(function(t){return l(t)})}function u(e,n){t.add({url:r(e,n)})}function a(t,e){return e=e||function(){return void 0},g(function(n){C[n.id]={location:t,query:e},h("router",d("routed",function(e){return e.location===t},b(n.id)))})}function c(){return v("router",v("waiting",p(function(){function t(t){return t===e}var e;j().subscribe(function(t){var n,o;l(C,t.state)&&"entry"===t.event&&(n=C[t.state],o=n.query.call(t.context),e=r(n.location,o),e="?/"===e?"?":e,u("/"===n.location?"":n.location,o))}),i().subscribe(function(e){if(!t(e.url)){var n=e.query||{},r=e.location||"/";y("routed",{location:r,query:n},0)}})})))}var s,l=e.object.has,f=e.type.is,d=e.state.builder.on,b=e.state.builder.gotoInternally,h=e.state.registerTransition,p=e.state.builder.onEntry,v=e.state.builder.state,y=e.state.raise,g=e.functional.builder.$yield,j=e.state.observe,C={};return s=t.observe().select(o).publishValue(void 0).refCount(),{route:a,routerState:c}}return e}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(t,e){function n(){o(t,{routing:e(t)})}function r(e){o(e,{routing:t.routing})}var o=t.object.extend;t.registerExtension({buildCore:n,buildSandbox:r})});