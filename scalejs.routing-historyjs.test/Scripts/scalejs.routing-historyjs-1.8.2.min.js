define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(e,t){function n(e){return t.pushState(e.data,e.title,e.url)}function r(){return t.getState()}function o(e){return t.replaceState(e.data,e.title,e.url)}function i(){var n=e.reactive.Observable,o=e.reactive.Disposable;return n.createWithDisposable(function(e){var n=t.Adapter.bind(window,"statechange",function(){e.onNext(r())});return o.create(function(){t.Adapter.unbind(n)})}).publishValue(r()).refCount()}return{add:n,get:r,replace:o,observe:i}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","scalejs.statechart-scion","scalejs.reactive"],function(e,t){function n(e){var t=e.split("&"),n={};return t.forEach(function(e){e=e.split("="),n[e[0]]=decodeURIComponent(e[1])}),n}function r(e,t){function n(e,t){var r=Object.keys(e);c(t)||(t=""),r.forEach(function(r){l(e[r],"object")?n(e[r],r):l(e[r],"array")?o.push(t+encodeURIComponent(r)+"="+encodeURIComponent(e[r].join(","))):o.push(t+encodeURIComponent(r)+"="+encodeURIComponent(e[r]))})}var r="",o=[];return c(e)&&(r="?"+e),c(t)&&(r+="?",n(t),r+=o.join("&")),r}function o(e){var t,r=e.hash.replace("/","");return 0===r.indexOf(".")&&(r=r.substr(1,r.length-1)),0!==r.indexOf("?")&&-1!==r.indexOf("?")&&(r=r.substr(r.indexOf("?"),r.length-1)),e=r.replace("?",""),""===e?{url:r,timestamp:(new Date).getTime()}:(e=e.split("?"),-1!==e[0].indexOf("&")?{query:n(e[0]),url:r,timestamp:(new Date).getTime()}:(t=decodeURIComponent(e[0]),c(e[1])?{location:t,query:n(e[1]),url:r,timestamp:(new Date).getTime()}:{location:t,url:r,timestamp:(new Date).getTime()}))}function i(e,n){w?(w=!1,t.replace({url:r(e,n)})):t.add({url:r(e,n)})}function a(e,t){return t=t||function(){return void 0},y(function(n){v[n.id]={location:e,query:t},j.push(f("routed",function(t){return t.data.location===e},p(n.id)))})}function u(){return t.observe().select(o)}function s(t){function n(){function e(e){return e===t}var t;l.add(m().subscribe(function(e){var n,o;c(v,e.state)&&"entry"===e.event&&(n=v[e.state],o=n.query.call(e.context),t=r(n.location,o),t="?/"===t?"?":t,i("/"===n.location?"":n.location,o))})),l.add(u().subscribe(function(t){if(!e(t.url)){var n=t.query||{},r=t.location||"/";c(a)&&(r=r.replace(new RegExp(a,"i"),"")),h("routed",{location:r||"/",query:n},0)}}))}var o,a,s,l=new e.reactive.CompositeDisposable;return c(t,"baseUrl")?(a=t.baseUrl,s=d(arguments).slice(1,arguments.length)):s=d(arguments),o=g.apply(null,["router",b(n),f("router.disposing",p("router.disposed")),g("router.waiting"),g("router.disposed",b(function(){l.dispose(),v={},j=[]}))].concat(j).concat(s))}var c=e.object.has,l=e.type.is,d=e.array.toArray,f=e.state.builder.on,p=e.state.builder.gotoInternally,b=e.state.builder.onEntry,g=e.state.builder.state,h=e.state.raise,y=e.functional.builder.$yield,m=e.state.observe,v={},j=[],w=!0;return{route:a,routerState:s}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(e,t){e.registerExtension({routing:t})});