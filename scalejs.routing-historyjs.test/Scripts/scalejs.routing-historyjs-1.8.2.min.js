define("scalejs.routing-historyjs/history",["scalejs!core","history","scalejs.reactive"],function(e,t){function n(e){return t.pushState(e.data,e.title,e.url)}function r(){return t.getState()}function o(e){return t.replaceState(e.data,e.title,e.url)}function i(){var n=e.reactive.Observable,o=e.reactive.Disposable;return n.createWithDisposable(function(e){var n=t.Adapter.bind(window,"statechange",function(){e.onNext(r())});return o.create(function(){t.Adapter.unbind(n)})}).publishValue(r()).refCount()}return{add:n,get:r,replace:o,observe:i}}),define("scalejs.routing-historyjs/routing",["scalejs!core","./history","scalejs.statechart-scion","scalejs.reactive"],function(e,t){function n(e){var t=e.split("&"),n={};return t.forEach(function(e){e=e.split("="),n[e[0]]=decodeURIComponent(e[1])}),n}function r(e,t){function n(e,t){var r=Object.keys(e);s(t)||(t=""),r.forEach(function(r){c(e[r],"object")?n(e[r],r):c(e[r],"array")?o.push(t+encodeURIComponent(r)+"="+encodeURIComponent(e[r].join(","))):o.push(t+encodeURIComponent(r)+"="+encodeURIComponent(e[r]))})}var r="",o=[];return s(e)&&(r="?"+e),s(t)&&(r+="?",n(t),r+=o.join("&")),r}function o(e){var t,r=e.hash.replace("/","");return 0===r.indexOf(".")&&(r=r.substr(1,r.length-1)),0!==r.indexOf("?")&&-1!==r.indexOf("?")&&(r=r.substr(r.indexOf("?"),r.length-1)),e=r.replace("?",""),""===e?{url:r,timestamp:(new Date).getTime()}:(e=e.split("?"),-1!==e[0].indexOf("&")?{query:n(e[0]),url:r,timestamp:(new Date).getTime()}:(t=decodeURIComponent(e[0]),s(e[1])?{location:t,query:n(e[1]),url:r,timestamp:(new Date).getTime()}:{location:t,url:r,timestamp:(new Date).getTime()}))}function i(e,n){j?(j=!1,t.replace({url:r(e,n)})):t.add({url:r(e,n)})}function a(e,t){return t=t||function(){return void 0},v(function(n){y[n.id]={location:e,query:t},f("router",l("routed",function(t){return t.data.location===e},d(n.id)))})}function u(n){function a(){return t.observe().select(o)}var u=new e.reactive.CompositeDisposable;return b("router",p(function(){function e(e){return e===t}var t;u.add(h().subscribe(function(e){var n,o;s(y,e.state)&&"entry"===e.event&&(n=y[e.state],o=n.query.call(e.context),t=r(n.location,o),t="?/"===t?"?":t,i("/"===n.location?"":n.location,o))})),u.add(a().subscribe(function(t){if(!e(t.url)){var r=t.query||{},o=t.location||"/";s(n)&&(o=o.replace(new RegExp(n,"i"),"")),g("routed",{location:o||"/",query:r},0)}}))}),l("router.disposing",d("router.disposed")),b("router.waiting"),b("router.disposed",p(function(){u.dispose()})))}var s=e.object.has,c=e.type.is,l=e.state.builder.on,d=e.state.builder.gotoInternally,f=e.state.registerTransition,p=e.state.builder.onEntry,b=e.state.builder.state,g=e.state.raise,v=e.functional.builder.$yield,h=e.state.observe,y={},j=!0;return{route:a,routerState:u}}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing"],function(e,t){e.registerExtension({routing:t})});