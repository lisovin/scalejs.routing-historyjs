define("scalejs.routing-historyjs/history",["scalejs!core","history"],function(e,t){function n(e){t.pushState(e.data,e.title,e.url)}function r(){t.getState()}function i(e){t.replaceState(e.data,e.title,e.url)}function s(){var n=e.reactive.Observable,r=e.reactive.Disposable;return n.createWithDisposable(function(e){var n=t.Adapter.bind(window,"statechange",function(){e.onNext(t.getState())});return r.create(function(){n.detach()})}).publishValue(t.getState()).refCount()}return{add:n,get:r,replace:i,observe:s}}),define("scalejs.routing-historyjs/routing",["./history"],function(e){function t(t){function d(e){var t=e.split("&"),n={};return t.forEach(function(e){e=e.split("="),n[e[0]]=decodeURIComponent(e[1])}),n}function v(e,t){function o(e,t){var i=Object.keys(e);n(t)||(t=""),i.forEach(function(n){r(e[n],"object")?o(e[n],n):r(e[n],"array")?s.push(t+encodeURIComponent(n)+"="+encodeURIComponent(e[n].join(","))):s.push(t+encodeURIComponent(n)+"="+encodeURIComponent(e[n]))})}var i="",s=[];return n(e)&&(i="?"+e),n(t)&&(i+="?",o(t),i+=s.join("&")),i}function m(e){var t,r=e.hash.replace("/","");return r.indexOf("&_suid")!==-1&&(r=r.substr(0,r.indexOf("&_suid"))),e=e.hash.replace("/","").replace("?",""),e===""?{url:r}:(e=e.split("?"),e[0].indexOf("&")!==-1?{query:d(e[0]),url:r}:(t=decodeURIComponent(e[0]),n(e[1])?{location:t,query:d(e[1]),url:r}:{location:t,url:r}))}function g(){return h.where(function(e){return n(e)})}function y(t,n){e.add({url:v(t,n)})}function b(e){window.history.go(n(e)?-e:-1)}function w(){e.replace({data:"",title:document.title,url:window.location.pathname+window.location.search})}function E(e,t){return t=t||function(){},l(function(n){p[n.id]={location:e,query:t},o("router",i(e+".routed",s(n.id)))})}function S(){return a("router",a("waiting",u(function(){function t(t){return t===e}var e="";c().subscribe(function(t){var r,i;n(p,t.state)&&t.event==="entry"&&(r=p[t.state],i=r.query.call(t.context),e=v(r.location,i),e=e==="?/"?"?":e,y(r.location==="/"?"":r.location,i))}),g().subscribe(function(e){if(t(e.url))return;var n=e.query||{},r=e.location||"/";f(r+".routed",n,0)})})))}var n=t.object.has,r=t.type.is,i=t.state.builder.on,s=t.state.builder.gotoInternally,o=t.state.registerTransition,u=t.state.builder.onEntry,a=t.state.builder.state,f=t.state.raise,l=t.functional.builder.$yield,c=t.state.observe,h,p={};return h=e.observe().select(m).publishValue(undefined).refCount(),{observe:g,navigate:y,removeHash:w,back:b,route:E,routerState:S}}return t}),define("scalejs.routing-historyjs",["scalejs!core","./scalejs.routing-historyjs/routing","scalejs.reactive","scalejs.statechart-scion"],function(e,t){function r(){n(e,{routing:t(e)})}function i(t){n(t,{routing:e.routing})}var n=e.object.extend;e.registerExtension({buildCore:r,buildSandbox:i})});