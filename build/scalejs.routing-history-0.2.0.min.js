define("scalejs.routing-history/history",["scalejs!core","history"],function(e,t){function n(e){t.pushState(e.data,e.title,e.url)}function r(){t.getState()}function i(e){t.replaceState(e.data,e.title,e.url)}function s(){var n=e.reactive.Observable,r=e.reactive.Disposable;return n.createWithDisposable(function(e){var n=t.Adapter.bind(window,"statechange",function(n){e.onNext(t.getState())});return r.create(function(){n.detach()})}).publishValue(t.getState()).refCount()}return{add:n,get:r,replace:i,observe:s}}),define("scalejs.routing-history/routing",["./history"],function(e){function t(t){function v(e){var t=e.split("&"),n={};return t.forEach(function(e){e=e.split("="),n[e[0]]=decodeURIComponent(e[1])}),n}function m(e,t){function o(e,t){var i=Object.keys(e);n(t)||(t=""),i.forEach(function(n){r(e[n],"object")?o(e[n],n):r(e[n],"array")?s.push(t+encodeURIComponent(n)+"="+encodeURIComponent(e[n].join(","))):s.push(t+encodeURIComponent(n)+"="+encodeURIComponent(e[n]))})}var i="",s=[];return n(e)&&(i="?"+e),n(t)&&(i+="?",o(t),i+=s.join("&")),i}function g(e){var t,r=e.hash.replace("/","");return e=e.hash.replace("/","").replace("?",""),e===""?{}:(e=e.split("?"),e[0].indexOf("&")!==-1?{query:v(e[0])}:(t=decodeURIComponent(e[0]),n(e[1])?{location:t,query:v(e[1]),url:r}:{location:t,url:r}))}function y(){return p.where(function(e){return n(e)})}function b(t,n){e.add({url:m(t,n)})}function w(e){window.history.go(n(e)?-e:-1)}function E(){e.replace({data:"",title:document.title,url:window.location.pathname+window.location.search})}function S(e,t){return t=t||function(){},c(function(n){d[n.id]={location:e,query:t},u("router",s(e+".routed",o(n.id)))})}function x(){return f("router",f("waiting",a(function(){function t(t){return t===e}var e="";h().subscribe(function(t){var r,i;n(d,t.state)&&t.event==="entry"&&(r=d[t.state],i=r.query.call(t.context),e=m(r.location,i),b(r.location,i))}),y().subscribe(function(e){if(t(e.url))return;var r=e.query||{};n(e.location)?l(e.location+".routed",r,0):l("default.routed",r,0)})})))}var n=t.object.has,r=t.type.is,i=t.object.merge,s=t.state.builder.on,o=t.state.builder.gotoInternally,u=t.state.registerTransition,a=t.state.builder.onEntry,f=t.state.builder.state,l=t.state.raise,c=t.functional.builder.$yield,h=t.state.observe,p,d={};return p=e.observe().select(g).publishValue(undefined).refCount(),{observe:y,navigate:b,removeHash:E,back:w,route:S,routerState:x}}return t}),define("scalejs.routing-history",["scalejs!core","./scalejs.routing-history/routing","scalejs.reactive","scalejs.statechart-scion"],function(e,t){function r(){n(e,{routing:t(e)})}function i(t){n(t,{routing:e.routing})}var n=e.object.extend;e.registerExtension({buildCore:r,buildSandbox:i})});